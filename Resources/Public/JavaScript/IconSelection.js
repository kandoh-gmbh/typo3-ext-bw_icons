define("TYPO3/CMS/BwIcons/IconSelection",["TYPO3/CMS/Backend/Modal","TYPO3/CMS/Core/Ajax/AjaxRequest","jquery"],((e,t,i)=>{return n={22:(e,t,i)=>{var n,s;n=[i,t,i(404),i(580),i(901)],void 0===(s=function(e,t,i,n,s){"use strict";return class{constructor(e,t){this.pid=e,this.iconProviders=t}onModalButtonClick(e){let t=TYPO3.settings.ajaxUrls.icon_selection;t+=t.indexOf("?")>0?"&":"?",t+="P[pid]="+this.pid,t+="&P[iconProviders]="+this.iconProviders,n.advanced({type:n.types.ajax,content:t,size:n.sizes.large,title:TYPO3.lang.icon_wizard_title,callback:e=>{this.currentModal=e},ajaxCallback:this.onModalLoaded.bind(this),buttons:[{text:TYPO3.lang.icon_wizard_save,name:"save",icon:"actions-document-save",active:!0,btnClass:"btn-primary",dataAttributes:{action:"save"},trigger:this.onModalSave.bind(this)}]})}onModalSave(){const e=i(this.currentModal).find('*[data-icon-name="'+this.selectedIconName+'"]').clone();this.$hiddenElement.val(this.selectedIconName),i(this.$formElement).find(".input-icon-holder").html(e),this.selectedIconName&&this.$formElement.find(".close").css("visibility","visible"),n.currentModal.trigger("modal-dismiss")}onClearButtonClick(e){this.$formElement.find(".input-icon-holder").html(""),this.$formElement.find(".close").css("visibility","hidden"),this.$hiddenElement.val("")}onModalLoaded(){this.currentModal.find("a.thumbnail").on("click",this.onIconClick.bind(this)),this.currentModal.find(".nav-tabs a").on("click",this.onNavTabClick.bind(this)),this.currentModal.find("input.search").on("input",this.onFilterInput.bind(this)),this.currentModal.find(".close").on("click",this.onFilterResetClick.bind(this))}onFilterResetClick(e){i(e.currentTarget).parent().find(".search").val(""),this.currentModal.find("input.search").trigger("input")}onFilterInput(e){const t=i(e.currentTarget).val(),n=i(e.currentTarget).closest(".tab-content");n.find(".griditem").removeClass("hidden"),n.find("h1").removeClass("hidden"),n.find(".list-group-item").removeClass("hidden"),n.find(".icongrid").removeClass("hidden"),n.find(".close").css("visibility","hidden"),t&&(n.find("*[data-icon-name]").parent().parent().addClass("hidden"),n.find('*[data-icon-base-name*="'+t+'"]').parent().parent().removeClass("hidden"),n.find(".close").css("visibility","visible")),i(".list-group-item",n).each((function(e,t){const s=i(t).attr("href").substr(1),a=n.find('h1[id="'+s+'"] + .icongrid .griditem:not(.hidden)').length;i("span",t).html(a),0===a&&(n.find('h1[id="'+s+'"]').addClass("hidden"),n.find('h1[id="'+s+'"] + .icongrid').addClass("hidden"),i(t).addClass("hidden"))})),i("h1:not([id]) span",n).html(n.find(".griditem:not(.hidden)").length)}onNavTabClick(e){e.preventDefault();const t=i(e.currentTarget).attr("href").substr(1);this.currentModal.find(".nav-tabs li, .nav-tabs li a").removeClass("active"),this.currentModal.find('.nav-tabs a[href="#'+t+'"]').addClass("active").parent().addClass("active"),this.currentModal.find(".tab-content").removeClass("active"),this.currentModal.find(".tab-content#"+t).addClass("active")}onIconClick(e){e.preventDefault(),this.currentModal.find("a.thumbnail").removeClass("active"),this.selectedIconName=i(e.currentTarget).children().first().attr("data-icon-name"),i(e.currentTarget).addClass("active")}injectStyleSheets(e){e.forEach((e=>{this.editor&&this.editor.document.$.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'+e+'" />'),parent.document.querySelector('link[href*="'+e+'"]')||parent.document.getElementsByTagName("head")[0].insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'+e+'" />')}))}loadAndIncludeStylesheets(){let e=TYPO3.settings.ajaxUrls.icon_stylesheets;e+=e.indexOf("?")>0?"&":"?",e+="pid="+this.pid,new s(e).get().then((async e=>{const t=await e.resolve();this.injectStyleSheets(t)}))}rteButtonClick(){const e=this.editor.config.IconPicker.routeUrl;n.advanced({type:n.types.ajax,content:e,size:n.sizes.large,title:this.editor.lang.IconPicker.modalTitle,callback:e=>this.currentModal=e,ajaxCallback:this.onModalLoaded.bind(this),buttons:[{text:this.editor.lang.IconPicker.save,name:"save",icon:"actions-document-save",active:!0,btnClass:"btn-primary",dataAttributes:{action:"save"},trigger:this.onRteModalSave.bind(this,this.editor)}]})}onRteModalSave(e){if(this.selectedIconName){const t=i(this.currentModal).find('*[data-icon-name="'+this.selectedIconName+'"]').get(0),n=new CKEDITOR.dom.element(t);e.insertElement(n),e.focus()}this.currentModal.trigger("modal-dismiss")}initForFormElement(e){this.loadAndIncludeStylesheets(),this.itemFormElName=e,this.$formElement=i('div[data-form-element="'+e+'"]'),this.$hiddenElement=i('input[name="'+e+'"]'),this.$formElement.find(".t3js-form-field-iconselection").on("click",this.onModalButtonClick.bind(this)),this.$formElement.find(".close").on("click",this.onClearButtonClick.bind(this))}initForRteEditor(e){this.editor=e,this.loadAndIncludeStylesheets()}}}.apply(t,n))||(e.exports=s)},580:t=>{"use strict";t.exports=e},901:e=>{"use strict";e.exports=t},404:e=>{"use strict";e.exports=i}},s={},a=function e(t){var i=s[t];if(void 0!==i)return i.exports;var a=s[t]={exports:{}};return n[t](a,a.exports,e),a.exports}(22),a;var n,s,a}));